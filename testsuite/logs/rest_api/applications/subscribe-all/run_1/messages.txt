[Jul 23 21:29:14] INFO[24103]: asterisk.test_case:173 __init__: Executing tests/rest_api/applications/subscribe-all
[Jul 23 21:29:14] INFO[24103]: asterisk.ari:342 __init__: WebSocketClientFactory(url=ws://127.0.0.1:8088/ari/events?app=testsuite&api_key=testsuite%3Atestsuite)
[Jul 23 21:29:14] INFO[24103]: asterisk.test_case:278 create_asterisk: Creating Asterisk instance 1
[Jul 23 21:29:15] INFO[24103]: asterisk.test_case:444 _start_asterisk: Starting Asterisk instance 1
[Jul 23 21:29:17] INFO[24103]: twisted:154 publishToNewObserver: Starting factory <asterisk.ari.AriClientFactory object at 0x7fae65fc8b50>
[Jul 23 21:29:17] INFO[24103]: asterisk.pluggable_modules:265 _handle_ws_open: testsuite
[Jul 23 21:29:17] INFO[24103]: asterisk.ari:485 post: POST http://127.0.0.1:8088/ari/applications/testsuite/subscription?eventSource=channel: {}
[Jul 23 21:29:17] INFO[24103]: asterisk.test_case:329 create_ami_factory: Creating AMIFactory 1 to 127.0.0.1
[Jul 23 21:29:17] INFO[24103]: twisted:154 publishToNewObserver: Starting factory <starpy.manager.AMIFactory instance at 0x7fae65f83ab8>
[Jul 23 21:29:17] INFO[24103]: AMI:184 connectionMade: Connection Made
[Jul 23 21:29:17] INFO[24103]: AMI:203 onComplete: Login Complete: {u'message': u'Authentication accepted', u'response': u'Success', u'actionid': u'35cc2ba0add2-140387011804192-1'}
[Jul 23 21:29:17] INFO[24103]: asterisk.test_case:582 _ami_connect: AMI Connect instance 1
[Jul 23 21:29:17] INFO[24103]: asterisk.ari:595 send: sent post applications/testsuite/subscription?eventSource=bridge: {} response 200 {
  "name": "testsuite",
  "channel_ids": [
    "__AST_CHANNEL_ALL_TOPIC"
  ],
  "bridge_ids": [
    "__AST_BRIDGE_ALL_TOPIC"
  ],
  "endpoint_ids": [],
  "device_names": []
}
[Jul 23 21:29:17] INFO[24103]: asterisk.ari:595 send: sent post applications/testsuite/subscription?eventSource=channel: {} response 200 {
  "name": "testsuite",
  "channel_ids": [
    "__AST_CHANNEL_ALL_TOPIC"
  ],
  "bridge_ids": [
    "__AST_BRIDGE_ALL_TOPIC"
  ],
  "endpoint_ids": [],
  "device_names": []
}
[Jul 23 21:29:17] INFO[24103]: asterisk.ari:595 send: sent post applications/testsuite/subscription?eventSource=endpoint: {} response 200 {
  "name": "testsuite",
  "channel_ids": [
    "__AST_CHANNEL_ALL_TOPIC"
  ],
  "bridge_ids": [
    "__AST_BRIDGE_ALL_TOPIC"
  ],
  "endpoint_ids": [
    "__AST_ENDPOINT_ALL_TOPIC"
  ],
  "device_names": []
}
[Jul 23 21:29:17] INFO[24103]: asterisk.ari:595 send: sent post applications/testsuite/subscription?eventSource=deviceState: {} response 200 {
  "name": "testsuite",
  "channel_ids": [
    "__AST_CHANNEL_ALL_TOPIC"
  ],
  "bridge_ids": [
    "__AST_BRIDGE_ALL_TOPIC"
  ],
  "endpoint_ids": [
    "__AST_ENDPOINT_ALL_TOPIC"
  ],
  "device_names": [
    "__AST_DEVICE_STATE_ALL_TOPIC"
  ]
}
[Jul 23 21:29:17] INFO[24103]: asterisk.ari:595 send: sent put asterisk/config/dynamic/res_pjsip/endpoint/alice {} response 200 [
  {
    "attribute": "rpid_immediate",
    "value": "false"
  },
  {
    "attribute": "webrtc",
    "value": "no"
  },
  {
    "attribute": "device_state_busy_at",
    "value": "0"
  },
  {
    "attribute": "t38_udptl_maxdatagram",
    "value": "0"
  },
  {
    "attribute": "dtls_rekey",
    "value": "0"
  },
  {
    "attribute": "named_pickup_group",
    "value": ""
  },
  {
    "attribute": "direct_media_method",
    "value": "invite"
  },
  {
    "attribute": "send_rpid",
    "value": "false"
  },
  {
    "attribute": "pickup_group",
    "value": ""
  },
  {
    "attribute": "sdp_session",
    "value": "Asterisk"
  },
  {
    "attribute": "dtls_verify",
    "value": "No"
  },
  {
    "attribute": "message_context",
    "value": ""
  },
  {
    "attribute": "mailboxes",
    "value": ""
  },
  {
    "attribute": "record_on_feature",
    "value": "automixmon"
  },
  {
    "attribute": "dtls_private_key",
    "value": ""
  },
  {
    "attribute": "dtls_fingerprint",
    "value": "SHA-256"
  },
  {
    "attribute": "from_domain",
    "value": ""
  },
  {
    "attribute": "timers_sess_expires",
    "value": "1800"
  },
  {
    "attribute": "named_call_group",
    "value": ""
  },
  {
    "attribute": "dtls_cipher",
    "value": ""
  },
  {
    "attribute": "media_encryption_optimistic",
    "value": "false"
  },
  {
    "attribute": "suppress_q850_reason_headers",
    "value": "false"
  },
  {
    "attribute": "aors",
    "value": "alice"
  },
  {
    "attribute": "identify_by",
    "value": "username,ip"
  },
  {
    "attribute": "callerid_privacy",
    "value": "allowed_not_screened"
  },
  {
    "attribute": "mwi_subscribe_replaces_unsolicited",
    "value": "false"
  },
  {
    "attribute": "cos_audio",
    "value": "0"
  },
  {
    "attribute": "follow_early_media_fork",
    "value": "true"
  },
  {
    "attribute": "context",
    "value": "default"
  },
  {
    "attribute": "rtp_symmetric",
    "value": "false"
  },
  {
    "attribute": "transport",
    "value": ""
  },
  {
    "attribute": "moh_suggest",
    "value": "default"
  },
  {
    "attribute": "t38_udptl",
    "value": "false"
  },
  {
    "attribute": "fax_detect",
    "value": "false"
  },
  {
    "attribute": "tos_video",
    "value": "0"
  },
  {
    "attribute": "srtp_tag_32",
    "value": "false"
  },
  {
    "attribute": "refer_blind_progress",
    "value": "true"
  },
  {
    "attribute": "max_audio_streams",
    "value": "1"
  },
  {
    "attribute": "bundle",
    "value": "false"
  },
  {
    "attribute": "use_avpf",
    "value": "false"
  },
  {
    "attribute": "call_group",
    "value": ""
  },
  {
    "attribute": "fax_detect_timeout",
    "value": "0"
  },
  {
    "attribute": "sdp_owner",
    "value": "-"
  },
  {
    "attribute": "force_rport",
    "value": "true"
  },
  {
    "attribute": "callerid_tag",
    "value": ""
  },
  {
    "attribute": "rtp_timeout_hold",
    "value": "0"
  },
  {
    "attribute": "use_ptime",
    "value": "false"
  },
  {
    "attribute": "media_address",
    "value": ""
  },
  {
    "attribute": "voicemail_extension",
    "value": ""
  },
  {
    "attribute": "rtp_timeout",
    "value": "0"
  },
  {
    "attribute": "set_var",
    "value": ""
  },
  {
    "attribute": "contact_acl",
    "value": ""
  },
  {
    "attribute": "preferred_codec_only",
    "value": "false"
  },
  {
    "attribute": "force_avp",
    "value": "false"
  },
  {
    "attribute": "record_off_feature",
    "value": "automixmon"
  },
  {
    "attribute": "from_user",
    "value": ""
  },
  {
    "attribute": "send_diversion",
    "value": "true"
  },
  {
    "attribute": "t38_udptl_ipv6",
    "value": "false"
  },
  {
    "attribute": "tone_zone",
    "value": ""
  },
  {
    "attribute": "language",
    "value": ""
  },
  {
    "attribute": "allow_subscribe",
    "value": "true"
  },
  {
    "attribute": "rtp_ipv6",
    "value": "false"
  },
  {
    "attribute": "callerid",
    "value": "<unknown>"
  },
  {
    "attribute": "moh_passthrough",
    "value": "false"
  },
  {
    "attribute": "cos_video",
    "value": "0"
  },
  {
    "attribute": "dtls_auto_generate_cert",
    "value": "No"
  },
  {
    "attribute": "asymmetric_rtp_codec",
    "value": "false"
  },
  {
    "attribute": "ice_support",
    "value": "false"
  },
  {
    "attribute": "aggregate_mwi",
    "value": "true"
  },
  {
    "attribute": "one_touch_recording",
    "value": "false"
  },
  {
    "attribute": "mwi_from_user",
    "value": ""
  },
  {
    "attribute": "accountcode",
    "value": ""
  },
  {
    "attribute": "allow",
    "value": "(ulaw|alaw)"
  },
  {
    "attribute": "rewrite_contact",
    "value": "false"
  },
  {
    "attribute": "user_eq_phone",
    "value": "false"
  },
  {
    "attribute": "rtp_engine",
    "value": "asterisk"
  },
  {
    "attribute": "subscribe_context",
    "value": ""
  },
  {
    "attribute": "notify_early_inuse_ringing",
    "value": "false"
  },
  {
    "attribute": "incoming_mwi_mailbox",
    "value": ""
  },
  {
    "attribute": "auth",
    "value": ""
  },
  {
    "attribute": "direct_media_glare_mitigation",
    "value": "none"
  },
  {
    "attribute": "trust_id_inbound",
    "value": "false"
  },
  {
    "attribute": "bind_rtp_to_media_address",
    "value": "false"
  },
  {
    "attribute": "disable_direct_media_on_nat",
    "value": "false"
  },
  {
    "attribute": "media_encryption",
    "value": "no"
  },
  {
    "attribute": "media_use_received_transport",
    "value": "false"
  },
  {
    "attribute": "allow_overlap",
    "value": "true"
  },
  {
    "attribute": "dtmf_mode",
    "value": "rfc4733"
  },
  {
    "attribute": "outbound_auth",
    "value": ""
  },
  {
    "attribute": "tos_audio",
    "value": "0"
  },
  {
    "attribute": "dtls_cert_file",
    "value": ""
  },
  {
    "attribute": "dtls_ca_path",
    "value": ""
  },
  {
    "attribute": "dtls_setup",
    "value": "active"
  },
  {
    "attribute": "connected_line_method",
    "value": "invite"
  },
  {
    "attribute": "g726_non_standard",
    "value": "false"
  },
  {
    "attribute": "100rel",
    "value": "yes"
  },
  {
    "attribute": "timers",
    "value": "yes"
  },
  {
    "attribute": "direct_media",
    "value": "true"
  },
  {
    "attribute": "acl",
    "value": ""
  },
  {
    "attribute": "timers_min_se",
    "value": "90"
  },
  {
    "attribute": "trust_id_outbound",
    "value": "false"
  },
  {
    "attribute": "sub_min_expiry",
    "value": "0"
  },
  {
    "attribute": "rtcp_mux",
    "value": "false"
  },
  {
    "attribute": "max_video_streams",
    "value": "1"
  },
  {
    "attribute": "accept_multiple_sdp_answers",
    "value": "false"
  },
  {
    "attribute": "send_pai",
    "value": "false"
  },
  {
    "attribute": "rtp_keepalive",
    "value": "0"
  },
  {
    "attribute": "t38_udptl_ec",
    "value": "none"
  },
  {
    "attribute": "t38_udptl_nat",
    "value": "false"
  },
  {
    "attribute": "allow_transfer",
    "value": "true"
  },
  {
    "attribute": "dtls_ca_file",
    "value": ""
  },
  {
    "attribute": "outbound_proxy",
    "value": ""
  },
  {
    "attribute": "inband_progress",
    "value": "false"
  }
]
[Jul 23 21:29:17] INFO[24103]: asterisk.ari:595 send: sent put asterisk/config/dynamic/res_pjsip/aor/alice {} response 200 [
  {
    "attribute": "minimum_expiration",
    "value": "60"
  },
  {
    "attribute": "default_expiration",
    "value": "3600"
  },
  {
    "attribute": "qualify_timeout",
    "value": "3.000000"
  },
  {
    "attribute": "mailboxes",
    "value": ""
  },
  {
    "attribute": "support_path",
    "value": "false"
  },
  {
    "attribute": "voicemail_extension",
    "value": ""
  },
  {
    "attribute": "max_contacts",
    "value": "0"
  },
  {
    "attribute": "authenticate_qualify",
    "value": "false"
  },
  {
    "attribute": "contact",
    "value": "sip:alice@127.0.0.1:5060;transport=udp"
  },
  {
    "attribute": "maximum_expiration",
    "value": "7200"
  },
  {
    "attribute": "qualify_frequency",
    "value": "5"
  },
  {
    "attribute": "remove_existing",
    "value": "false"
  },
  {
    "attribute": "outbound_proxy",
    "value": ""
  }
]
[Jul 23 21:29:17] INFO[24103]: asterisk.ari:595 send: sent put asterisk/config/dynamic/res_pjsip/identify/alice {} response 200 [
  {
    "attribute": "match",
    "value": "127.0.0.1/255.255.255.255"
  },
  {
    "attribute": "srv_lookups",
    "value": "true"
  },
  {
    "attribute": "endpoint",
    "value": "alice"
  },
  {
    "attribute": "match_header",
    "value": ""
  }
]
[Jul 23 21:29:17] INFO[24103]: asterisk.ari:595 send: sent post channels {'endpoint': 'Local/dial_alice@default', 'extension': 'echo'} response 200 {
  "id": "1532395757.0",
  "name": "Local/dial_alice@default-00000000;1",
  "state": "Down",
  "caller": {
    "name": "",
    "number": ""
  },
  "connected": {
    "name": "",
    "number": ""
  },
  "accountcode": "",
  "dialplan": {
    "context": "default",
    "exten": "dial_alice",
    "priority": 1
  },
  "creationtime": "2018-07-23T21:29:17.455-0400",
  "language": "en"
}
[Jul 23 21:29:17] INFO[24103]: asterisk.pluggable_modules:274 _handle_ws_event: Tracking channel {u'accountcode': u'', u'name': u'Local/dial_alice@default-00000000;1', u'language': u'en', u'caller': {u'name': u'', u'number': u''}, u'creationtime': u'2018-07-23T21:29:17.455-0400', u'state': u'Down', u'connected': {u'name': u'', u'number': u''}, u'dialplan': {u'priority': 1, u'exten': u'dial_alice', u'context': u'default'}, u'id': u'1532395757.0'}
[Jul 23 21:29:17] INFO[24103]: asterisk.pluggable_modules:274 _handle_ws_event: Tracking channel {u'accountcode': u'', u'name': u'Local/dial_alice@default-00000000;2', u'language': u'en', u'caller': {u'name': u'', u'number': u''}, u'creationtime': u'2018-07-23T21:29:17.456-0400', u'state': u'Ring', u'connected': {u'name': u'', u'number': u''}, u'dialplan': {u'priority': 1, u'exten': u'dial_alice', u'context': u'default'}, u'id': u'1532395757.2'}
[Jul 23 21:29:17] INFO[24103]: asterisk.pluggable_modules:274 _handle_ws_event: Tracking channel {u'accountcode': u'', u'name': u'PJSIP/alice-00000000', u'language': u'en', u'caller': {u'name': u'', u'number': u''}, u'creationtime': u'2018-07-23T21:29:17.462-0400', u'state': u'Down', u'connected': {u'name': u'', u'number': u''}, u'dialplan': {u'priority': 1, u'exten': u's', u'context': u'default'}, u'id': u'1532395757.4'}
[Jul 23 21:29:17] INFO[24103]: asterisk.pluggable_modules:274 _handle_ws_event: Tracking channel {u'accountcode': u'', u'name': u'PJSIP/alice-00000001', u'language': u'en', u'caller': {u'name': u'Anonymous', u'number': u'anonymous'}, u'creationtime': u'2018-07-23T21:29:17.472-0400', u'state': u'Ring', u'connected': {u'name': u'', u'number': u''}, u'dialplan': {u'priority': 1, u'exten': u'1000', u'context': u'default'}, u'id': u'1532395757.7'}
[Jul 23 21:29:19] INFO[24103]: asterisk.pluggable_modules:277 _handle_ws_event: Destroyed channel {u'accountcode': u'', u'name': u'PJSIP/alice-00000001', u'language': u'en', u'caller': {u'name': u'Anonymous', u'number': u'anonymous'}, u'creationtime': u'2018-07-23T21:29:17.472-0400', u'state': u'Up', u'connected': {u'name': u'', u'number': u''}, u'dialplan': {u'priority': 4, u'exten': u'1000', u'context': u'default'}, u'id': u'1532395757.7'}
[Jul 23 21:29:19] INFO[24103]: asterisk.pluggable_modules:277 _handle_ws_event: Destroyed channel {u'accountcode': u'', u'name': u'Local/dial_alice@default-00000000;2', u'language': u'en', u'caller': {u'name': u'', u'number': u''}, u'creationtime': u'2018-07-23T21:29:17.456-0400', u'state': u'Up', u'connected': {u'name': u'', u'number': u'dial_alice'}, u'dialplan': {u'priority': 2, u'exten': u'dial_alice', u'context': u'default'}, u'id': u'1532395757.2'}
[Jul 23 21:29:19] INFO[24103]: asterisk.pluggable_modules:277 _handle_ws_event: Destroyed channel {u'accountcode': u'', u'name': u'Local/dial_alice@default-00000000;1', u'language': u'en', u'caller': {u'name': u'', u'number': u'dial_alice'}, u'creationtime': u'2018-07-23T21:29:17.455-0400', u'state': u'Up', u'connected': {u'name': u'', u'number': u''}, u'dialplan': {u'priority': 2, u'exten': u'echo', u'context': u'default'}, u'id': u'1532395757.0'}
[Jul 23 21:29:19] INFO[24103]: asterisk.pluggable_modules:277 _handle_ws_event: Destroyed channel {u'accountcode': u'', u'name': u'PJSIP/alice-00000000', u'language': u'en', u'caller': {u'name': u'', u'number': u'dial_alice'}, u'creationtime': u'2018-07-23T21:29:17.462-0400', u'state': u'Up', u'connected': {u'name': u'', u'number': u''}, u'dialplan': {u'priority': 1, u'exten': u'', u'context': u'default'}, u'id': u'1532395757.4'}
[Jul 23 21:29:19] INFO[24103]: asterisk.pluggable_modules:281 _handle_ws_event: All channels have hungup; stopping test after 3 seconds
[Jul 23 21:29:22] WARNING[24103]: twisted:154 publishToNewObserver: dropping connection to peer tcp4:127.0.0.1:8088 with abort=False: None
[Jul 23 21:29:22] INFO[24103]: asterisk.test_case:487 __stop_instances: Stopping Asterisk instance 1
[Jul 23 21:29:22] INFO[24103]: twisted:154 publishToNewObserver: Stopping factory <asterisk.ari.AriClientFactory object at 0x7fae65fc8b50>
[Jul 23 21:29:22] INFO[24103]: AMI:1136 clientConnectionLost: connection lost, reconnecting...
[Jul 23 21:29:22] INFO[24103]: twisted:154 publishToNewObserver: <twisted.internet.tcp.Connector instance at 0x7fae65f83b90> will retry in 2 seconds
[Jul 23 21:29:22] INFO[24103]: AMI:1139 clientConnectionLost: None
[Jul 23 21:29:22] INFO[24103]: twisted:154 publishToNewObserver: Stopping factory <starpy.manager.AMIFactory instance at 0x7fae65f83ab8>
[Jul 23 21:29:22] ERROR[24103]: asterisk.ari:778 on_stop: Expected 1 <= count <= 1; was 0 ({'peer': {'peer_status': 'Reachable'}, 'application': 'testsuite', 'endpoint': {'technology': 'PJSIP', 'state': 'online', 'resource': 'alice'}, 'type': 'PeerStatusChange'}, !None)
[Jul 23 21:29:22] INFO[24103]: asterisk.test_case:508 __stop_reactor: Stopping Reactor
[Jul 23 21:29:22] INFO[24103]: twisted:154 publishToNewObserver: Main loop terminated.
[Jul 23 21:29:22] INFO[24103]: test_runner:308 main: Test run for tests/rest_api/applications/subscribe-all completed with result False
